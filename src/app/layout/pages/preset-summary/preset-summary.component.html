<div class="grid grid-nogutter" style="min-width: 1200px">
  <!-- Top: Job class selector (horizontal listbox, same as current) -->
  <div class="col-12 mb-2">
    <div class="grid grid-nogutter column_list">
      <p-listbox [options]="allClasses" [(ngModel)]="selectedJobId" (onChange)="onJobChange()" [disabled]="isLoading">
        <ng-template let-item pTemplate="item" class="py-0">
          <div class="flex gap-2 py-0">
            <img src="assets/demo/images/jobs/icon_jobs_{{ item.icon }}.png" alt="" class="job_img" />
            <div class="text_ellips">{{ item.label }}</div>
          </div>
        </ng-template>
      </p-listbox>
    </div>
  </div>

  <div class="col-12 grid grid-nogutter">
    <!-- Sidebar -->
    <div class="col-3">
      <!-- Skill ranking list -->
      <p-listbox
        [options]="skillRankings"
        [(ngModel)]="selectedSkillName"
        optionValue="skill_name"
        [listStyle]="{ height: '350px' }"
        (onChange)="onSkillChange()"
        [disabled]="isLoading"
      >
        <ng-template let-item pTemplate="item" class="py-0">
          <div class="w-full flex justify-content-between">
            <div class="text_ellips">{{ item.skill_name }}</div>
            <div class="text-color-secondary text-sm ml-2 white-space-nowrap">{{ item.build_count }} builds</div>
          </div>
        </ng-template>
      </p-listbox>

      <!-- Selected item description -->
      <div class="card px-1 py-3 sticky desc-sticky" *ngIf="displaySelectedItem">
        <div class="text-lg font-bold mb-3">Descrição do Item</div>
        <div class="flex gap-1 mb-2">
          <img src="assets/demo/images/items/{{ displaySelectedItem.id }}.png" alt="" class="item_img" />
          <div class="text_ellips font-medium">{{ displaySelectedItem.name }}</div>
        </div>
        <div class="px-2 py-2" style="color: #000; background-color: #fff" [innerHTML]="displaySelectedItem.desc"></div>
      </div>
    </div>

    <!-- Main content: slot ranking cards -->
    <div class="col-9">
      <div *ngIf="isLoading" class="flex justify-content-center p-5">
        <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
      </div>

      <div *ngIf="!isLoading && slotGroups.length === 0 && selectedSkillName" class="text-center text-color-secondary p-5">
        Sem dados para esta skill.
      </div>

      <ng-container *ngFor="let category of categories">
        <ng-container *ngIf="getGroupsByCategory(category) as groups">
          <div *ngIf="groups.length > 0" class="mb-2">
            <div class="text-xl font-bold mb-3 mt-2 pl-2 text-color-secondary">{{ categoryLabels[category] }}</div>
            <div class="grid grid-nogutter">
              <div *ngFor="let group of groups" class="col-6 p-1">
                <app-slot-ranking-card
                  [group]="group"
                  (itemClick)="onItemClick($event)"
                ></app-slot-ranking-card>
              </div>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>
</div>
